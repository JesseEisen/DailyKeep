---
title: AWK And Shell FAQ
updated: 2015-12-31  16:21
---

## 1.How to make calculation on hexadecimal number in awk?

It is very easy to convert a hexadecimal number to decimal.but if you use the `gawk`
you need to specify a flag. Here is the example

```bash
awk $([[ $(awk --version) = GNU* ]] && echo --non-decimal-data) -f ...
$5=sprintf("%d","0x"$2)  

#or 
$5=strtonum("0x"$2)
```

Explain:
if the $2 is `0000000ff`, so the $5 will be `255`.


### reference

•[convert-hex-to-dec](http://stackoverflow.com/questions/4614775/converting-hex-to-decimal-in-awk-or-sed)    
•[calc-hex-with-awk](http://stackoverflow.com/questions/3683110/how-to-make-calculations-on-hexadecimal-numbers-with-awk)


## 2.Embedding awk in shell script

use the `read` and `Heredocument` to insert the awk script

```bash
################################
# AWK scripts                  #
################################
read -d '' scriptVariable << 'EOF'
BEGIN {
   print "start"
}
{
   print $0
}
END{
   print "hello"
}
EOF
################################
# End of AWK Scripts           #
################################

awk "$scriptVariable" ${inputfile}
```


## 3.Travel position parameters

Only use the `while`, `$#` and `shift` to make that:

```bash
while (( "$#" )); do 
   echo  "$1"
   shift
done
```

## 4.Getopts To parse command line parameters

First We use an example:

```bash
while getopts "a:b:c" opts; do
	case $opts in 
	  a) 
	     append=$OPTARG
		 ;;
	  b) 
	     behandl=$OPTARG
		 ;;
	 c) 
	     flag=1
		 ;;
	 \?)
	    usage
		;;
   esac
done
shift $((OPTIND-1))
```

That's the normal usage of `getopts`. Here is the explaination of this code:

+ OPTIND   
  Holds the index to the next argument to be processed.Also useful to shift the positional parameters after processing with `getopts`. `OPTIND` is initially set to 1, and **need to be re-set to 1 if you want to parse anything again with getopts.**

+ OPTARG   
  This variable is set to any argument foa an option found by `getopt`. 

And We if the option need an argument, we can add the `:` behind them. Also if you do not want to use the `getopts`. you can use the mannual way to parser that.

